dwd层和dim层主要做的事情是

分区表

采用压缩

列式存储

去重

json字段解析

脏数据处理，不可用的例如都为null的，关键计算字段存在null值的换为默认值

脱敏，例如手机号

降维

降维之后的维度表有六七张，大概是用户，商品，活动，优惠券，省份，日期

较特殊的，商品维度表来源大概有七八张，例如sku，spu，商品分类1,2,3，平台属性，平台优惠，商品优惠等

然后用户维度表是拉链表，

拉链表的制作是首次导入给用户信息加上999的有效期，之后每次导入是先fulljoin ods层用户信息表，是当天，和dimuserinfo表是标记enddate为999 ，得到的数据分三类，一类是ods相关字段有数据，dwd为null，证明是新增的数据，要放在999分区，一类是dim有数据，ods为null，证明是没变化的数据，也放入999分区，字段都有值的说明是进行了更新，

维度建模



